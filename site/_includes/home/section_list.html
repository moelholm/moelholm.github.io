
<div class="card{% if include.kind != 'toots' %} mb-3{% endif %}">
  <div class="card-body">
    <h5 class="mb-2 d-flex align-items-center gap-1">{{ include.title }}{% if include.emoji %} <span class="emoji-badge ml-1">{{ include.emoji }}</span>{% endif %}</h5>
    {%- assign list = include.items -%}
    {%- if list and list.size > 0 -%}
      <div class="home-samples{% if include.grid %} {{ include.grid }}{% endif %}">
        {%- for item in list limit: include.limit -%}
          {%- if include.kind == 'toots' -%}
            {% include home/item_compact.html item=item kind='toots' badge_html='üêò' more_link='/toots/' %}
          {%- elsif include.kind == 'activities' -%}
            {%- assign anchor_id = item.id -%}
            {%- assign link = '/activities/#activities-' | append: anchor_id -%}
            {%- comment -%}Compute whole kilometers from meters (floor, no decimals).{%- endcomment -%}
            {%- assign distance_m = item.distance_m | plus: 0 -%}
            {%- assign distance = '' -%}
            {%- if distance_m > 0 -%}
              {%- assign distance_km_float = distance_m | divided_by: 1000.0 -%}
              {%- assign distance = distance_km_float | floor -%}
            {%- endif -%}
            {%- assign elev = item.elevation_gain_m -%}
            {%- assign dur_seconds = item.moving_time_s | default: item.elapsed_time_s -%}
            {%- assign date_text = item.date | date: "%Y-%m-%d %H:%M" | append: " UTC" -%}
            {%- assign date_iso = item.date | date_to_xmlschema -%}
            {%- capture metrics_html -%}
              <div class="home-race-metrics" aria-label="Activity metrics">
                {% if distance != '' and distance > 0 %}
                  <div class="metric metric--distance" title="Distance">
                    <span class="metric-icon"><i class="fa-solid fa-route" aria-hidden="true"></i></span>
                    <span class="metric-value">{{ distance }}<span class="unit"> km</span></span>
                  </div>
                {% endif %}
                {% if elev and elev > 0 %}
                  <div class="metric metric--vert" title="Elevation gain">
                    <span class="metric-icon"><i class="fa-solid fa-mountain" aria-hidden="true"></i></span>
                    <span class="metric-value">{{ elev }}<span class="unit"> m</span></span>
                  </div>
                {% endif %}
                {% if dur_seconds %}
                  <div class="metric metric--time" title="Duration">
                    <span class="metric-icon"><i class="fa-regular fa-clock" aria-hidden="true"></i></span>
                    <span class="metric-value">{% include duration_format.html seconds=dur_seconds %}</span>
                  </div>
                {% endif %}
              </div>
            {%- endcapture -%}
            {% include card.html
              wrap_in_col=false
              id=anchor_id
              title=item.name
              href=link
              badge_html='üèÉ'
              body_html=''
              date_text=date_text
              date_iso=date_iso
              cta_label='open'
              cta_href=link
              extra_html=metrics_html
              class_modifiers='blog-item--compact'
              card_classes='home-post home-post--compact position-relative'
              card_body_classes='py-2'
            %}
          {%- elsif include.kind == 'running' -%}
            {%- assign date_text = item.date | date: "%Y-%m-%d %H:%M" | append: " UTC" -%}
              {%- assign date_iso = item.date | date_to_xmlschema -%}
            {%- capture body_html -%}{{ item.content | strip_html | truncate: 140 }}{%- endcapture -%}
            {%- assign is_race = false -%}{% if item.tags contains 'race' %}{%- assign is_race = true -%}{% endif %}
            {%- assign badge = 'üèÉ' -%}{% if is_race %}{%- assign badge = 'üìñ' -%}{% endif %}
            {%- assign class_mods = 'blog-item--compact' -%}
            {%- if is_race -%}{%- assign class_mods = class_mods | append: ' race' -%}{%- endif -%}
            {% include card.html
              wrap_in_col=false
              id=item.id
              title=item.title
              href=item.url
              badge_html=badge
              body_html=body_html
              date_text=date_text
                date_iso=date_iso
              cta_label="open"
              cta_href=item.url
              class_modifiers=class_mods
              card_classes='home-post home-post--compact position-relative'
              card_body_classes='py-2'
            %}
          {%- elsif include.kind == 'results' -%}
            {%- assign date_text = item.race_date | default: item.date | date: "%Y-%m-%d %H:%M" | append: " UTC" -%}
              {%- assign date_iso = item.race_date | default: item.date | date_to_xmlschema -%}
            {%- capture metrics_html -%}
              <div class="home-race-metrics" aria-label="Race metrics">
                {% if item.distance_km %}
                  <div class="metric metric--distance" title="Distance">
                    <span class="metric-icon"><i class="fa-solid fa-route" aria-hidden="true"></i></span>
                    <span class="metric-value">{{ item.distance_km }}<span class="unit"> km</span></span>
                  </div>
                {% endif %}
                {% if item.elevation_gain_m %}
                  <div class="metric metric--vert" title="Elevation gain">
                    <span class="metric-icon"><i class="fa-solid fa-mountain" aria-hidden="true"></i></span>
                    <span class="metric-value">{{ item.elevation_gain_m }}<span class="unit"> m</span></span>
                  </div>
                {% endif %}
                {% if item.duration_formatted %}
                  <div class="metric metric--time" title="Duration">
                    <span class="metric-icon"><i class="fa-regular fa-clock" aria-hidden="true"></i></span>
                    <span class="metric-value">{{ item.duration_formatted }}</span>
                  </div>
                {% endif %}
              </div>
            {%- endcapture -%}
            {% capture tags_html %}{% include home/race_type_tags.html post=item %}{% endcapture %}
            {% capture extra_html %}{{ metrics_html }}<div class="home-sample-tags">{{ tags_html }}</div>{% endcapture %}
            {% include card.html
              wrap_in_col=false
              id=item.id
              title=item.title
              href=item.url
              badge_html='üèÅ'
              body_html=''
              date_text=date_text
                date_iso=date_iso
              cta_label="open"
              cta_href=item.url
              extra_html=extra_html
              class_modifiers='blog-item--compact race'
              card_classes='home-post home-post--compact position-relative'
              card_body_classes='py-2'
            %}
          {%- endif -%}
        {%- endfor -%}
      </div>
      {%- if include.more_url -%}
      <div class="text-right"><a class="btn btn-sm" href="{{ include.more_url }}">More</a></div>
      {%- endif -%}
    {%- else -%}
  <p>No {% if include.kind == 'toots' %}updates{% elsif include.kind == 'activities' %}activities{% elsif include.kind == 'running' %}posts{% else %}results{% endif %} found.</p>
    {%- endif -%}
  </div>
</div>
