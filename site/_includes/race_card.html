{% comment %}
Race Card Include - Renders a single race card
Parameters:
- date: Race date (YYYY-MM-DD format)
- title: Race title
- distance: Race distance (e.g., "100 km", "6h", "‚ôæÔ∏è")
- tags: Array of tag strings (e.g., ["ultra", "trail"])
- url: Race information URL
{% endcomment %}

{% comment %}Infer row_classes from tags only (not from distance){% endcomment %}
{% assign row_classes = '' %}

{% assign is_ultra = false %}
{% for tag in include.tags %}
  {% if tag == 'ultra' %}
    {% assign is_ultra = true %}
  {% endif %}
{% endfor %}

{% if is_ultra %}
  {% assign row_classes = row_classes | append: 'tag-ultra ' %}
{% else %}
  {% assign row_classes = row_classes | append: 'tag-non-ultra ' %}
{% endif %}

{% comment %}Check if trail or road{% endcomment %}
{% assign is_trail = false %}
{% for tag in include.tags %}
  {% if tag == 'trail' %}
    {% assign is_trail = true %}
  {% endif %}
{% endfor %}

{% if is_trail %}
  {% assign row_classes = row_classes | append: 'tag-trail ' %}
{% else %}
  {% assign row_classes = row_classes | append: 'tag-road ' %}
{% endif %}

{% comment %}Check if backyard{% endcomment %}
{% for tag in include.tags %}
  {% if tag == 'backyard' %}
    {% assign row_classes = row_classes | append: 'tag-backyard ' %}
  {% endif %}
{% endfor %}

<tr class="{{ row_classes | strip }}">
  <td class="race-details-cell" colspan="2">
    {% capture title_html %}{{ include.title }}{% endcapture %}
    {% capture body_html %}
      <div class="race-meta">
        <span class="meta-item distance-value">{{ include.distance }}</span>
        {% if include.tags %}
          <span class="race-tags-inline race-tags-group">
            {% for tag in include.tags %}
              {% comment %}Infer CSS class from tag name{% endcomment %}
              {% assign tag_class = '' %}
              {% if tag == 'ultra' %}
                {% assign tag_class = 'race-tag-ultra' %}
              {% elsif tag == 'trail' %}
                {% assign tag_class = 'race-tag-trail' %}
              {% elsif tag == 'marathon' %}
                {% assign tag_class = 'race-tag-marathon' %}
              {% elsif tag == 'half' %}
                {% assign tag_class = 'race-tag-half' %}
              {% elsif tag == 'backyard' %}
                {% assign tag_class = 'race-tag-backyard' %}
              {% endif %}
              <span class="race-tag {{ tag_class }}">{{ tag }}</span>
            {% endfor %}
          </span>
        {% endif %}
        <a href="{{ include.url }}" class="race-tag" target="_blank" rel="noopener">üîó race info</a>
      </div>
    {% endcapture %}
    {% capture datetime_text %}{{ include.date }}{% endcapture %}
    {% include table_card.html datetime_text=datetime_text title_html=title_html body_html=body_html href=include.url %}
  </td>
</tr>
